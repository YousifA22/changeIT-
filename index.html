<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>changeIT!</title>
    <link href='https://fonts.googleapis.com/css?family=Advent Pro' rel='stylesheet'>
    <style>
        body {
            font-family: 'Advent Pro';
            background: linear-gradient(135deg, rgba(198, 204, 244, 0.7), rgba(236, 219, 252, 0.7), rgba(76, 112, 175, 0.7));
            background-size: cover;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            min-height: 100vh;
        }
        .navbar {
            width: 97%;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 5px;
            background: transparent;
            border-bottom: 2px solid #ac99ea52;
            position: relative;
            top: 0;
            left: 0;
            z-index: 1000;
        }
        .navbar .logo {
            font-size: 1.5rem;
            font-weight: 700;
            color: #333;
        }
        
        .container {
            width: 90%;
            max-width: 800px;
            background: #ffffff;
            border-radius: 20px;
            box-shadow: 0px 8px 24px rgba(0, 0, 0, 0.15);
            padding: 40px;
            text-align: center;
            position: relative;
            margin-top: 20px;
        }
        header {
            font-size: 4rem;
            font-weight: 700;
            color: #36466f;
            margin-bottom: 20px;
            margin-top: 75px;
        }
        .description {
            font-size: 1.2rem;
            color: #555;
            max-width: 800px;
            text-align: center;
            margin-bottom: 50px;
        }
        .input-area {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        .input-group {
            width: 100%;
        }
        label {
            font-weight: 700;
            margin-bottom: 8px;
            display: block;
            text-align: left;
            color: #555;
        }
        textarea {
            width: 100%;
            padding: 15px;
            font-size: 1rem;
            border: 1px solid #ddd;
            border-radius: 10px;
            box-shadow: inset 0px 2px 8px rgba(0, 0, 0, 0.05);
            transition: border 0.3s;
        }
        textarea:focus {
            border-color: #b5a7e5;
            outline: none;
        }
        #job-desc {
            height: 150px;
        }
        #modified-experience {
            height: 250px;
        }
        .upload-button {
            border: 2px dashed #b5a7e5;
            padding: 30px;
            border-radius: 10px;
            background: #f8f8f8;
            cursor: pointer;
            transition: background 0.3s;
        }
        .upload-button:hover {
            background: #f1f1ff;
        }
        .upload-button input[type="file"] {
            display: none;
        }
        .upload-button p {
            font-size: 1rem;
            color: #666;
            margin: 0;
        }
        .file-name {
            font-size: 0.9rem;
            color: #555;
            margin-top: 10px;
        }
        .how-it-works {
            display: flex;
            justify-content: space-between;
            margin: 60px 0;
            gap: 20px;
        }
        .how-it-works-title {
            font-size: 2rem;
            font-weight: 700;
            color: #36466f;
            text-align: center;
            margin-bottom: 20px;
        }
        .bubble {
            flex: 0.75;
            padding: 15px;
            border-radius: 10px;
            background: #f0f0ff;
            box-shadow: 0px 4px 12px rgba(0, 0, 0, 0.1);
        }
        .bubble h3 {
            font-size: 1.1rem;
            color: #333;
            margin-bottom: 10px;
        }
        .bubble p {
            font-size: 0.9rem;
            color: #666;
        }
        button {
            width: 100%;
            padding: 15px;
            font-size: 1.2rem;
            background: #6f42c1;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: background 0.3s;
            margin-top: 20px;
        }
        button:hover {
            background: #5933a9;
        }
        .pulsing {
            animation: pulsing 1.5s infinite alternate ease-in-out;
        }
        @keyframes pulsing {
            0% {
                background-color: #6f42c1;
            }
            100% {
                background-color: #8a5edc;
            }
        }
    </style>
</head>
<body>
    <div class="navbar">
        <div class="logo" style="text-align: center;">changeIT!</div>
        <div class="slogan" style="text-align: center; width: 15%; font-size: 1.2rem; color: #555;">The ultimate resume analyzer</div>
        
        
    </div>
    <header>Get the perfect resume</header>
    <div class="description">
        Transform your resume with AI to perfectly match your dream job. Our tool takes your existing work experience and optimizes it based on the job description you provide, making sure your resume stands out without adding any false information.
    </div>
    <div class="container">
        <form id="resume-form" enctype="multipart/form-data">
            <div class="input-area">
                <div class="input-group">
                    <label for="job-desc">Enter the Job Description:</label>
                    <textarea id="job-desc" name="job-desc" placeholder="Paste the job description here..."></textarea>
                </div>
                <div class="upload-button" id="resume-upload">
                    <input type="file" id="resume" name="resume" accept=".pdf,.doc,.docx">
                    <p>Drag & drop your resume here, or click to browse.</p>
                    <span class="file-name" id="file-name"></span>
                </div>
                <button type="button" id="customize-btn">Customize My Resume</button>
                <div class="input-group">
                    <label for="modified-experience">Modified Experience:</label>
                    <textarea id="modified-experience" name="modified-experience" readonly placeholder="Your modified experience will appear here..."></textarea>
                </div>
            </div>
        </form>
    </div>
    <h2 class="how-it-works-title">How It Works</h2>
    <div class="how-it-works">
        <div class="bubble">
            <h3>1. Upload Your Resume</h3>
            <p>Upload your resume in PDF format. Our system will analyze and extract your work experience to tailor it to the specific job you're applying for.</p>
        </div>
        <div class="bubble">
            <h3>2. Provide the Job Description</h3>
            <p>Paste the job description into the provided field. This helps us understand what the employer is looking for and align your resume accordingly.</p>
        </div>
        <div class="bubble">
            <h3>3. Enhance Your Experience</h3>
            <p>Click 'Customize My Resume,' and our AI will refine your work experience to better match the job requirements, while ensuring your resume remains truthful and relevant.</p>
        </div>
    </div>
</body>
<script>
    document.getElementById('resume-upload').addEventListener('click', function () {
        document.getElementById('resume').click();
    });

    document.getElementById('resume').addEventListener('change', function () {
        const fileName = document.getElementById('resume').files[0]?.name;
        if (fileName) {
            document.getElementById('file-name').textContent = `Selected file: ${fileName}`;
        } else {
            document.getElementById('file-name').textContent = '';
        }
    });

    document.addEventListener('DOMContentLoaded', function() {
        document.getElementById('customize-btn').addEventListener('click', async function () {
            const jobDesc = document.getElementById('job-desc').value;
            const resumeFile = document.getElementById('resume').files[0];
            const customizeButton = document.getElementById('customize-btn');

            if (!jobDesc || !resumeFile) {
                alert('Please provide both the job description and upload your resume.');
                return;
            }

            const formData = new FormData();
            formData.append('job_desc', jobDesc);
            formData.append('resume', resumeFile);
            
            try {
                // Add pulsing animation to button
                customizeButton.classList.add('pulsing');
                customizeButton.disabled = true;

                // Make the fetch POST request to the backend
                const response = await fetch('http://localhost:5000/process_resumee', {
                    method: 'POST',
                    body: formData,
                });
                
                // Remove pulsing animation from button
                customizeButton.classList.remove('pulsing');
                customizeButton.disabled = false;

                // Check if the request was successful
                if (response.ok) {
                    const result = await response.json(); // Wait for the JSON response

                    // Display the result in the text area
                    if (result.modified_experience) {
                        document.getElementById('modified-experience').value = result.modified_experience;
                        console.log('Modified experience updated in the UI.');
                    } else {
                        console.error('Response received, but "modified_experience" is missing or undefined:', result);
                        alert('An error occurred: Modified experience was not returned.');
                    }
                } else {
                    console.error('Failed to process the resume:', response.status, response.statusText);
                    const errorResponse = await response.text(); // Wait for the error text
                    console.error('Error details:', errorResponse);
                    alert('Failed to process the resume. Please try again later.');
                }
            } catch (error) {
                // Remove pulsing animation from button in case of error
                customizeButton.classList.remove('pulsing');
                customizeButton.disabled = false;
                console.error('Error occurred during the request:', error);
                alert('An error occurred while processing your request.');
            }
        });
    });
</script>
</html>
